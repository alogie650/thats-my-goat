<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>That's My GOAT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
        :root { --team-color: #39FF14; }
        
        body { 
            background-color: #000; 
            color: #fff; 
            font-family: 'VT323', monospace; 
            font-size: 15px; 
            margin: 0; 
            text-transform: uppercase; 
            letter-spacing: 0.1em;
            overflow-x: hidden;
        }

        .solid-box { background: #000; border: 2px solid #333; position: relative; }
        .dynamic-neon { color: var(--team-color); transition: all 0.4s ease; }
        .gold-glow { color: #FFD700; }
        
        #player-search { 
            caret-color: transparent; 
            background: transparent; 
            letter-spacing: 0.15em; 
            padding-left: 28px !important; 
        }
        
        #fake-cursor { 
            position: absolute; 
            width: 10px; 
            height: 20px; 
            background-color: var(--team-color); 
            animation: blink 0.6s step-end infinite; 
            pointer-events: none; 
            top: 50%; 
            transform: translateY(-50%); 
            left: 14px; 
            z-index: 10;
        }
        
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }
        
        .stat-label { font-size: 1.05rem; opacity: 0.6; display: block; margin-bottom: 3px; }
        .stat-value { font-size: 1.5rem; font-weight: bold; display: block; }
        .analysis-text { line-height: 1.3; color: #eee; white-space: pre-wrap; }
        
        .stat-tag { 
            font-size: 1.35rem; 
            border: 2px solid var(--team-color); 
            padding: 9px 21px; 
            margin-right: 12px; 
            margin-bottom: 12px; 
            color: var(--team-color); 
            display: inline-block; 
            font-weight: bold; 
        }

        .suggestion-item { border-bottom: 1px solid #111; cursor: pointer; transition: 0.2s; font-size: 1.1rem; }
        .suggestion-item:hover { background: var(--team-color); color: #000; }
    </style>
</head>
<body class="min-h-screen p-3 md:p-9" onload="initTerminal()">

    <div class="max-w-5xl mx-auto relative z-10">
        <header class="text-center mb-8">
            <h1 class="text-7xl md:text-9xl font-normal tracking-tighter">THAT'S MY <span class="dynamic-neon">GOAT</span></h1>
        </header>

        <div class="relative max-w-xl mx-auto mb-8">
            <div id="search-container" class="solid-box p-1 flex items-center border-white/20 focus-within:border-[var(--team-color)]">
                <div class="relative flex-1 flex items-center h-[45px]">
                    <input id="player-search" type="text" autocomplete="off" autofocus placeholder="SEARCH PLAYER..."
                           class="w-full bg-transparent text-white outline-none font-bold text-xl uppercase"
                           oninput="handleInput(this)">
                    <div id="fake-cursor"></div>
                </div>
            </div>
            <div id="suggestions" class="hidden absolute left-0 right-0 mt-1 solid-box z-50 bg-black max-h-[300px] overflow-y-auto"></div>
        </div>

        <div id="result-area" class="hidden">
            <div id="player-card" class="solid-box p-6 md:p-9 border-l-[9px] border-[var(--team-color)] transition-all duration-500">
                <div class="flex flex-col md:flex-row justify-between items-start mb-8 gap-5">
                    <div>
                        <h2 id="p-name" class="text-4xl md:text-6xl font-bold dynamic-neon leading-none mb-1"></h2>
                        <p id="p-team" class="text-2xl text-white opacity-70 tracking-widest"></p>
                    </div>
                    <div class="text-left md:text-right min-w-[210px]">
                        <div class="mb-4">
                            <span class="block text-lg opacity-80 mb-1 font-bold">CHAMPIONSHIPS</span>
                            <div id="p-rings" class="text-4xl gold-glow tracking-widest"></div>
                        </div>
                        <div>
                            <span class="block text-lg opacity-80 mb-1 font-bold">LEAGUE MVPS</span>
                            <div id="p-mvps" class="text-4xl dynamic-neon tracking-widest"></div>
                        </div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-9 bg-white/5 p-6 border border-white/10">
                    <div><span class="stat-label">HEIGHT / WEIGHT</span><span id="p-phys" class="stat-value"></span></div>
                    <div><span class="stat-label">POSITION</span><span id="p-pos" class="stat-value"></span></div>
                    <div><span class="stat-label">ACTIVE SINCE</span><span id="p-exp" class="stat-value"></span></div>
                </div>

                <div class="mb-10">
                    <h3 class="dynamic-neon text-4xl font-bold mb-6 flex items-center">
                        <span class="mr-3 text-3xl">‚ñ∂</span> PLAYER ANALYSIS
                    </h3>
                    <div id="p-case" class="analysis-text text-2xl md:text-3xl italic border-l-3 border-white/20 pl-6"></div>
                </div>

                <div class="border-t border-white/10 pt-9">
                    <span class="block text-3xl dynamic-neon font-bold mb-8">DATA POINTS</span>
                    <div id="p-sig" class="flex flex-wrap"></div>
                </div>
            </div>
        </div>
    </div>

    <span id="text-measurer" style="visibility: hidden; position: absolute; white-space: pre; font-family: 'VT323'; font-size: 20px; letter-spacing: 0.15em;"></span>

    <script>
        const API_KEY = "d5bf99e2-09d5-44fd-8e09-d00c9e679c6f";
        
        const TEAM_COLORS = {
            'LAL': '#FDB927', 'GSW': '#FFFF00', 'CHI': '#CE1141', 'SAS': '#C4CED4',
            'BOS': '#007A33', 'PHX': '#E56020', 'MIL': '#00471B', 'DEN': '#FEC524'
        };

        const LOCAL_DB = [
            { first_name: "Michael", last_name: "Jordan", team: { full_name: "Chicago Bulls", abbreviation: "CHI" }, height: "6-6", weight: "216", position: "Guard", rings: 6, mvps: 5, rookie: 1984, blurb: "THE STANDARD OF EXCELLENCE. 6-0 FINALS RECORD.", sigs: ["DPOY 1988", "10X SCORING CHAMP"] },
            { first_name: "LeBron", last_name: "James", team: { full_name: "Los Angeles Lakers", abbreviation: "LAL" }, height: "6-9", weight: "250", position: "Forward", rings: 4, mvps: 4, rookie: 2003, blurb: "UNPRECEDENTED LONGEVITY. THE ONLY 40K/11K/11K PLAYER.", sigs: ["ALL-TIME SCORING LEADER", "4X FINALS MVP"] },
            { first_name: "Kareem", last_name: "Abdul-Jabbar", team: { full_name: "Los Angeles Lakers", abbreviation: "LAL" }, height: "7-2", weight: "225", position: "Center", rings: 6, mvps: 6, rookie: 1969, blurb: "THE SKYHOOK REMAINS THE MOST UNGUARDABLE SHOT IN HISTORY.", sigs: ["6X MVP", "38,387 PTS"] }
        ];

        let debounceTimer;

        function initTerminal() { document.getElementById('player-search').focus(); updateCursor(); }

        function updateCursor() {
            const input = document.getElementById('player-search');
            const measurer = document.getElementById('text-measurer');
            const cursor = document.getElementById('fake-cursor');
            measurer.textContent = input.value || "";
            cursor.style.left = (14 + measurer.offsetWidth) + "px";
        }

        function handleInput(el) {
            updateCursor();
            const val = el.value.trim().toLowerCase();
            if (val.length < 2) { 
                document.getElementById('suggestions').classList.add('hidden'); 
                return; 
            }

            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(async () => {
                // 1. Get Local Matches
                const localMatches = LOCAL_DB.filter(p => 
                    `${p.first_name} ${p.last_name}`.toLowerCase().includes(val)
                );
                
                // 2. Get API Matches
                let apiMatches = [];
                try {
                    const response = await fetch(`https://api.balldontlie.io/nba/v1/players?search=${val}`, {
                        headers: { "Authorization": API_KEY }
                    });
                    const result = await response.json();
                    apiMatches = result.data || [];
                } catch (e) {
                    console.error("API Error", e);
                }

                // 3. Combine and Render
                renderSuggestions(localMatches, apiMatches);
            }, 300);
        }

        function renderSuggestions(locals, apis) {
            const dropdown = document.getElementById('suggestions');
            dropdown.innerHTML = '';
            
            const combined = [...locals];
            const seen = new Set(locals.map(l => `${l.first_name} ${l.last_name}`.toLowerCase()));

            apis.forEach(p => {
                const fullName = `${p.first_name} ${p.last_name}`.toLowerCase();
                if (!seen.has(fullName)) {
                    combined.push(p);
                    seen.add(fullName);
                }
            });

            if (combined.length === 0) { dropdown.classList.add('hidden'); return; }

            combined.slice(0, 10).forEach(p => {
                const div = document.createElement('div');
                div.className = 'suggestion-item p-3 font-bold';
                div.innerHTML = `${p.first_name} ${p.last_name} <span class="opacity-30 ml-2">// ${p.team?.abbreviation || 'NBA'}</span>`;
                div.onclick = () => selectPlayer(p);
                dropdown.appendChild(div);
            });
            dropdown.classList.remove('hidden');
        }

        async function typeWriter(text, elementId, speed = 8) {
            const el = document.getElementById(elementId);
            el.innerHTML = "";
            for (let i = 0; i < text.length; i++) {
                el.innerHTML += text.charAt(i);
                await new Promise(r => setTimeout(r, speed));
            }
        }

        async function selectPlayer(p) {
            document.getElementById('suggestions').classList.add('hidden');
            const color = TEAM_COLORS[p.team?.abbreviation] || '#39FF14';
            document.documentElement.style.setProperty('--team-color', color);
            document.getElementById('player-search').value = "";
            updateCursor();
            document.getElementById('result-area').classList.remove('hidden');
            
            document.getElementById('p-sig').innerHTML = '';
            (p.sigs || ["NBA DATA SOURCE", "ACTIVE STATUS"]).forEach(s => {
                const span = document.createElement('span');
                span.className = 'stat-tag';
                span.innerText = s;
                document.getElementById('p-sig').appendChild(span);
            });

            await typeWriter(`${p.first_name} ${p.last_name}`, 'p-name', 12);
            await typeWriter(p.team?.full_name || "Free Agent", 'p-team', 10);
            
            document.getElementById('p-rings').innerHTML = p.rings ? "üèÜ".repeat(p.rings) : "N/A";
            document.getElementById('p-mvps').innerHTML = p.mvps ? "‚≠ê".repeat(p.mvps) : "N/A";
            document.getElementById('p-phys').innerText = `${p.height || '??'} / ${p.weight || '??'} LBS`;
            document.getElementById('p-pos').innerText = p.position || "N/A";
            document.getElementById('p-exp').innerText = p.rookie || "Active";
            
            const blurb = p.blurb || `DATA RETRIEVED FROM LIVE API. ${p.first_name} ${p.last_name} IS A ${p.position} CURRENTLY PLAYING FOR THE ${p.team?.full_name}.`;
            await typeWriter(blurb, 'p-case', 4);
        }
    </script>
</body>
</html>
